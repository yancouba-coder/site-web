{"ast":null,"code":"import $ from 'jquery';\nvar libelle_container = $(\"div#libelle\");\nvar sections_container = $(\"div#sections\");\nvar json = JSON.parse($(\"p#mydata\").html());\nvar tmp_json = 1;\nvar labelle_table = []; // Ajout de \"Input\" pour un parent donné\n\nfunction add_input_to_parent(key, parent, i) {\n  var newdiv = document.createElement(\"div\");\n  newdiv.id = i;\n  newdiv.className = \"my-2 px-3\";\n  var newCloseButton = document.createElement(\"button\");\n  newCloseButton.className = \"btn-close\";\n  newCloseButton.type = \"button\";\n  newCloseButton.setAttribute(\"aria-label\", \"Close\");\n\n  newCloseButton.onclick = function () {\n    delete json[labelle_table[i]];\n    $('div#' + i).remove();\n  };\n\n  newdiv.append(newCloseButton);\n  var newInput = document.createElement(\"input\");\n  newInput.value = key;\n  newInput.className = \"capitalized formLabel formLabel-large text-mediumblue\";\n\n  newInput.onchange = function () {\n    var current_val = this.value;\n    var current_id = labelle_table[i];\n\n    if (this.value.length > 0) {\n      if (!json.hasOwnProperty(current_val)) {\n        labelle_table[i] = current_val;\n        json = JSON.parse(JSON.stringify(json).replace(current_id, current_val));\n      } else {\n        this.value = current_id;\n        alert(\"Ce champ est déjà existant.\");\n      }\n    } else {\n      this.value = current_id;\n      alert(\"Impossible de mettre un libellé vide.\");\n    }\n  };\n\n  newdiv.append(newInput);\n  newdiv.append(document.createElement(\"br\"));\n  newdiv.append(document.createElement(\"br\"));\n  parent.append(newdiv);\n} // Ajout de \"Section\" pour un parent donné\n\n\nfunction add_section_to_parent(data, section_id, parent) {\n  var newdiv = document.createElement(\"div\");\n  newdiv.id = \"section\" + section_id;\n  newdiv.className = \"section\";\n  var newdivBlock = document.createElement(\"div\");\n  newdivBlock.className = \"block block-large\";\n  var newdivst = document.createElement(\"div\");\n  newdivst.className = \"sous-titre\";\n  var newInput = document.createElement(\"input\");\n  newInput.value = data[\"titre\"];\n  newInput.id = data[\"titre\"];\n  newInput.className = \"capitalized formLabel formLabel-large text-mediumblue\";\n\n  newInput.onchange = function () {\n    var current_val = this.value;\n    var already_exist = false;\n\n    if (this.value.length > 0) {\n      var current_id = this.id;\n\n      for (var j = 0; j < json['sections'].length; j++) {\n        if (json['sections'][j]['titre'] === current_val) {\n          already_exist = true;\n        }\n      }\n\n      if (!already_exist) {\n        json = JSON.parse(JSON.stringify(json).replace(current_id, current_val));\n        this.id = current_val;\n      } else {\n        this.value = current_id;\n        alert(\"Une section possède déjà ce titre.\");\n      }\n    } else {\n      this.value = this.id;\n      alert(\"Impossible de mettre un titre vide.\");\n    }\n  };\n\n  var newDeleteSectionButton = document.createElement(\"button\");\n  newDeleteSectionButton.className = \"btn-close\";\n  newDeleteSectionButton.type = \"button\";\n  newDeleteSectionButton.id = 'buttonsection' + section_id;\n  newDeleteSectionButton.setAttribute(\"aria-label\", \"Close\");\n\n  newDeleteSectionButton.onclick = function () {\n    json[\"sections\"].splice(section_id, 1);\n    $('div#' + 'section' + section_id).remove();\n  };\n\n  newdivst.append(newInput);\n  newdivst.append(newDeleteSectionButton);\n  newdivBlock.append(newdivst);\n  var newtable = document.createElement(\"table\");\n  newtable.className = \"table\";\n  var newthead = document.createElement(\"thead\");\n  var newtr = document.createElement(\"tr\");\n  var newth = document.createElement(\"th\");\n  newtr.append(newth);\n  var newInputchoice = document.createElement(\"input\");\n\n  var _loop = function _loop(i) {\n    newth = document.createElement(\"th\");\n    newInputchoice = document.createElement(\"input\");\n    newInputchoice.value = data['choix'][i];\n    newInputchoice.className = \"text-center text-mediumblue w-80\";\n\n    newInputchoice.onchange = function () {\n      var already_exist = false;\n\n      if (this.value.length > 0) {\n        for (var j = 0; j < data['choix'].length; j++) {\n          if (data['choix'][j] === this.value) {\n            already_exist = true;\n          }\n        }\n\n        if (!already_exist) {\n          data['choix'][i] = this.value;\n        } else {\n          this.value = data['choix'][i];\n          alert(\"Un choix possède déjà cet intitulé.\");\n        }\n      } else {\n        this.value = data['choix'][i];\n        alert(\"Impossible de mettre un choix vide.\");\n      }\n    };\n\n    var newCloseButtonChoice = document.createElement(\"button\");\n    newCloseButtonChoice.className = \"btn-close\";\n    newCloseButtonChoice.type = \"button\";\n    newCloseButtonChoice.setAttribute(\"aria-label\", \"Close\");\n\n    newCloseButtonChoice.onclick = function () {\n      for (var _i6 = 0; _i6 < json['sections'].length; _i6++) {\n        $(\"div#section\" + _i6).remove();\n      }\n\n      data['choix'].splice(i, 1);\n\n      for (var _i7 = 0; _i7 < json['sections'].length; _i7++) {\n        add_section_to_parent(json['sections'][_i7], _i7, sections_container);\n      }\n    };\n\n    newth.append(newInputchoice);\n    newth.append(newCloseButtonChoice);\n    newtr.append(newth);\n  };\n\n  for (var i = 0; i < data[\"choix\"].length; i++) {\n    _loop(i);\n  }\n\n  newth = document.createElement(\"th\");\n  newth.className = \"text-right\";\n  var newAddChoixButton = document.createElement(\"button\");\n  newAddChoixButton.className = \"btn btn-round btn-sm px-3 mt-2\";\n  newAddChoixButton.type = \"button\";\n  newAddChoixButton.id = \"add_choix_button_\" + section_id;\n  newAddChoixButton.innerHTML = '+';\n\n  newAddChoixButton.onclick = function () {\n    for (var _i = 0; _i < json['sections'].length; _i++) {\n      $(\"div#section\" + _i).remove();\n    }\n\n    data['choix'].push(\"Choix#\" + data['choix'].length);\n\n    for (var _i2 = 0; _i2 < json['sections'].length; _i2++) {\n      add_section_to_parent(json['sections'][_i2], _i2, sections_container);\n    }\n  };\n\n  newth.append(newAddChoixButton);\n  newtr.append(newth);\n  newthead.append(newtr);\n  newtable.append(newthead);\n  var newtbody = document.createElement(\"tbody\");\n  var newtd;\n\n  var _loop2 = function _loop2(_i3) {\n    newtr = document.createElement(\"tr\");\n    newtd = document.createElement(\"td\");\n    newInputchoice = document.createElement(\"input\");\n    newInputchoice.value = data['competences'][_i3][\"intitule\"];\n    newInputchoice.className = \"w-80\";\n\n    newInputchoice.onchange = function () {\n      var already_exist = false;\n\n      if (this.value.length > 0) {\n        for (var j = 0; j < data['competences'].length; j++) {\n          if (data['competences'][j][\"intitule\"] === this.value) {\n            already_exist = true;\n          }\n        }\n\n        if (!already_exist) {\n          data['competences'][_i3][\"intitule\"] = this.value;\n        } else {\n          this.value = data['competences'][_i3][\"intitule\"];\n          alert(\"Un choix possède déjà cet intitulé.\");\n        }\n      } else {\n        this.value = data['competences'][_i3][\"intitule\"];\n        alert(\"Impossible de mettre un choix vide.\");\n      }\n    };\n\n    var newCloseButtonChoice = document.createElement(\"button\");\n    newCloseButtonChoice.className = \"btn-close\";\n    newCloseButtonChoice.type = \"button\";\n    newCloseButtonChoice.setAttribute(\"aria-label\", \"Close\");\n\n    newCloseButtonChoice.onclick = function () {\n      for (var _i8 = 0; _i8 < json['sections'].length; _i8++) {\n        $(\"div#section\" + _i8).remove();\n      }\n\n      data['competences'].splice(_i3, 1);\n\n      for (var _i9 = 0; _i9 < json['sections'].length; _i9++) {\n        add_section_to_parent(json['sections'][_i9], _i9, sections_container);\n      }\n    };\n\n    newtd.append(newCloseButtonChoice);\n    newtd.append(newInputchoice);\n    newtr.append(newtd);\n    var newInputRadioButton = void 0;\n\n    var _loop3 = function _loop3(j) {\n      newtd = document.createElement(\"td\");\n      newtd.className = \"text-center\";\n      newInputRadioButton = document.createElement(\"input\");\n      newInputRadioButton.type = \"radio\";\n      newInputRadioButton.name = data['competences'][_i3][\"intitule\"];\n\n      if (data['competences'][_i3][\"requis\"] == j) {\n        newInputRadioButton.checked = true;\n        newInputRadioButton.className += \" requis\";\n      }\n\n      newInputRadioButton.onclick = function () {\n        data['competences'][_i3][\"requis\"] = j;\n      };\n\n      newtd.append(newInputRadioButton);\n      newtr.append(newtd);\n    };\n\n    for (var j = 0; j < data['choix'].length; j++) {\n      _loop3(j);\n    }\n\n    newtbody.append(newtr);\n  };\n\n  for (var _i3 = 0; _i3 < data[\"competences\"].length; _i3++) {\n    _loop2(_i3);\n  }\n\n  newtable.append(newtbody);\n  newdivBlock.append(newtable);\n  var newAddButtonCompetences = document.createElement(\"button\");\n  newAddButtonCompetences.className = \"btn btn-round btn-sm px-3 mt-2\";\n  newAddButtonCompetences.type = \"button\";\n  newAddButtonCompetences.id = \"add_competences_button\";\n  newAddButtonCompetences.innerHTML = '+';\n\n  newAddButtonCompetences.onclick = function () {\n    for (var _i4 = 0; _i4 < json['sections'].length; _i4++) {\n      $(\"div#section\" + _i4).remove();\n    }\n\n    data['competences'].push({\n      \"intitule\": \"competence#\" + data['competences'].length,\n      \"requis\": 0,\n      \"selection\": -1\n    });\n\n    for (var _i5 = 0; _i5 < json['sections'].length; _i5++) {\n      add_section_to_parent(json['sections'][_i5], _i5, sections_container);\n    }\n  };\n\n  newdivBlock.append(newAddButtonCompetences);\n  newdiv.append(newdivBlock);\n  parent.append(newdiv);\n}\n\nfunction commentaire_manager() {\n  // Ajout du commentaire dans le formulaire\n  if (json.hasOwnProperty('commentaire')) {\n    delete json[\"commentaire\"];\n  } else {\n    // Suppression du commentaire dans le formulaire\n    json[\"commentaire\"] = \"\";\n  }\n}\n\nfunction add_label() {\n  var key = \"libelle#\" + Math.floor(Math.random() * 9000);\n  labelle_table.push(key);\n  json[key] = \"\";\n  add_input_to_parent(key, libelle_container, labelle_table.length - 1);\n}\n\nfunction add_section() {\n  var key = {\n    \"titre\": \"Titre n°\" + Math.floor(Math.random() * 5),\n    \"choix\": [],\n    \"competences\": []\n  };\n  json['sections'].push(key);\n  add_section_to_parent(key, json['sections'].length - 1, sections_container);\n}\n\nfunction send_json() {\n  var xhr = new XMLHttpRequest();\n  var url = $('button#send_button').val();\n  xhr.open(\"POST\", url, true);\n  xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n  xhr.send(JSON.stringify(json));\n  window.location.replace(url);\n} // Fonction de génération des champs personalisable par le JSON en BDD\n\n\nfunction main() {\n  var j = 0;\n  console.log(json);\n\n  for (var key in json) {\n    switch (key) {\n      case 'commentaire':\n        $('input#commentaire').attr(\"checked\", \"checked\");\n        break;\n\n      case 'sections':\n        for (var i = 0; i < json['sections'].length; i++) {\n          add_section_to_parent(json['sections'][i], i, sections_container);\n        }\n\n        break;\n\n      default:\n        labelle_table.push(key);\n        add_input_to_parent(key, libelle_container, j++);\n    }\n  }\n}\n\nmain(); // Event Listener\n\n$(function () {\n  return $('button#add_label_button').on('click', function () {\n    return add_label();\n  });\n}, $('button#send_button').on('click', function () {\n  return send_json();\n}), $('button#add_section_button').on('click', function () {\n  return add_section();\n}), $('input#commentaire').on('change', function () {\n  return commentaire_manager();\n}));\n$('select#ver').change(function () {\n  window.location.replace($(this).val());\n});","map":{"version":3,"sources":["/mnt/c/Users/thier/RubymineProjects/MIAGEStage/app/javascript/packs/ge_formats.js"],"names":["$","libelle_container","sections_container","json","JSON","parse","html","tmp_json","labelle_table","add_input_to_parent","key","parent","i","newdiv","document","createElement","id","className","newCloseButton","type","setAttribute","onclick","remove","append","newInput","value","onchange","current_val","current_id","length","hasOwnProperty","stringify","replace","alert","add_section_to_parent","data","section_id","newdivBlock","newdivst","already_exist","j","newDeleteSectionButton","splice","newtable","newthead","newtr","newth","newInputchoice","newCloseButtonChoice","newAddChoixButton","innerHTML","push","newtbody","newtd","newInputRadioButton","name","checked","newAddButtonCompetences","commentaire_manager","add_label","Math","floor","random","add_section","send_json","xhr","XMLHttpRequest","url","val","open","setRequestHeader","send","window","location","main","console","log","attr","on","change"],"mappings":"AAAA,OAAOA,CAAP,MAAc,QAAd;AAEA,IAAIC,iBAAiB,GAAGD,CAAC,CAAC,aAAD,CAAzB;AACA,IAAIE,kBAAkB,GAAGF,CAAC,CAAC,cAAD,CAA1B;AACA,IAAIG,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWL,CAAC,CAAC,UAAD,CAAD,CAAcM,IAAd,EAAX,CAAX;AACA,IAAIC,QAAQ,GAAG,CAAf;AAEA,IAAIC,aAAa,GAAG,EAApB,C,CAEA;;AACA,SAASC,mBAAT,CAA6BC,GAA7B,EAAkCC,MAAlC,EAA0CC,CAA1C,EAA6C;AACzC,MAAIC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAb;AACAF,EAAAA,MAAM,CAACG,EAAP,GAAYJ,CAAZ;AACAC,EAAAA,MAAM,CAACI,SAAP,GAAmB,WAAnB;AAEA,MAAIC,cAAc,GAAGJ,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAArB;AACAG,EAAAA,cAAc,CAACD,SAAf,GAA2B,WAA3B;AACAC,EAAAA,cAAc,CAACC,IAAf,GAAsB,QAAtB;AACAD,EAAAA,cAAc,CAACE,YAAf,CAA4B,YAA5B,EAA0C,OAA1C;;AACAF,EAAAA,cAAc,CAACG,OAAf,GAAyB,YAAW;AAChC,WAAOlB,IAAI,CAACK,aAAa,CAACI,CAAD,CAAd,CAAX;AACAZ,IAAAA,CAAC,CAAC,SAASY,CAAV,CAAD,CAAcU,MAAd;AACH,GAHD;;AAIAT,EAAAA,MAAM,CAACU,MAAP,CAAcL,cAAd;AAEA,MAAIM,QAAQ,GAAGV,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAf;AACAS,EAAAA,QAAQ,CAACC,KAAT,GAAiBf,GAAjB;AACAc,EAAAA,QAAQ,CAACP,SAAT,GAAqB,uDAArB;;AACAO,EAAAA,QAAQ,CAACE,QAAT,GAAoB,YAAW;AAC3B,QAAIC,WAAW,GAAG,KAAKF,KAAvB;AACA,QAAIG,UAAU,GAAGpB,aAAa,CAACI,CAAD,CAA9B;;AACA,QAAI,KAAKa,KAAL,CAAWI,MAAX,GAAoB,CAAxB,EAA2B;AACvB,UAAI,CAAC1B,IAAI,CAAC2B,cAAL,CAAoBH,WAApB,CAAL,EAAuC;AACnCnB,QAAAA,aAAa,CAACI,CAAD,CAAb,GAAmBe,WAAnB;AACAxB,QAAAA,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAYD,IAAI,CAAC2B,SAAL,CAAe5B,IAAf,CAAD,CAAuB6B,OAAvB,CAA+BJ,UAA/B,EAA2CD,WAA3C,CAAX,CAAP;AACH,OAHD,MAGO;AACH,aAAKF,KAAL,GAAaG,UAAb;AACAK,QAAAA,KAAK,CAAC,6BAAD,CAAL;AACH;AACJ,KARD,MAQO;AACH,WAAKR,KAAL,GAAaG,UAAb;AACAK,MAAAA,KAAK,CAAC,uCAAD,CAAL;AACH;AACJ,GAfD;;AAgBApB,EAAAA,MAAM,CAACU,MAAP,CAAcC,QAAd;AAEAX,EAAAA,MAAM,CAACU,MAAP,CAAcT,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAd;AACAF,EAAAA,MAAM,CAACU,MAAP,CAAcT,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAd;AACAJ,EAAAA,MAAM,CAACY,MAAP,CAAcV,MAAd;AACH,C,CAED;;;AACA,SAASqB,qBAAT,CAA+BC,IAA/B,EAAqCC,UAArC,EAAiDzB,MAAjD,EAAyD;AACrD,MAAIE,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAb;AACAF,EAAAA,MAAM,CAACG,EAAP,GAAa,YAAYoB,UAAzB;AACAvB,EAAAA,MAAM,CAACI,SAAP,GAAmB,SAAnB;AAEA,MAAIoB,WAAW,GAAGvB,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAlB;AACAsB,EAAAA,WAAW,CAACpB,SAAZ,GAAwB,mBAAxB;AAEA,MAAIqB,QAAQ,GAAGxB,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAf;AACAuB,EAAAA,QAAQ,CAACrB,SAAT,GAAqB,YAArB;AAEA,MAAIO,QAAQ,GAAGV,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAf;AACAS,EAAAA,QAAQ,CAACC,KAAT,GAAiBU,IAAI,CAAC,OAAD,CAArB;AACAX,EAAAA,QAAQ,CAACR,EAAT,GAAcmB,IAAI,CAAC,OAAD,CAAlB;AACAX,EAAAA,QAAQ,CAACP,SAAT,GAAqB,uDAArB;;AACAO,EAAAA,QAAQ,CAACE,QAAT,GAAoB,YAAW;AAC3B,QAAIC,WAAW,GAAG,KAAKF,KAAvB;AACA,QAAIc,aAAa,GAAG,KAApB;;AAEA,QAAI,KAAKd,KAAL,CAAWI,MAAX,GAAoB,CAAxB,EAA2B;AACvB,UAAID,UAAU,GAAG,KAAKZ,EAAtB;;AACA,WAAK,IAAIwB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrC,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CW,CAAC,EAA9C,EAAkD;AAC9C,YAAIrC,IAAI,CAAC,UAAD,CAAJ,CAAiBqC,CAAjB,EAAoB,OAApB,MAAiCb,WAArC,EAAkD;AAC9CY,UAAAA,aAAa,GAAG,IAAhB;AACH;AACJ;;AACD,UAAI,CAACA,aAAL,EAAoB;AAChBpC,QAAAA,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAYD,IAAI,CAAC2B,SAAL,CAAe5B,IAAf,CAAD,CAAuB6B,OAAvB,CAA+BJ,UAA/B,EAA2CD,WAA3C,CAAX,CAAP;AACA,aAAKX,EAAL,GAAUW,WAAV;AACH,OAHD,MAGO;AACH,aAAKF,KAAL,GAAaG,UAAb;AACAK,QAAAA,KAAK,CAAC,oCAAD,CAAL;AACH;AACJ,KAdD,MAcO;AACH,WAAKR,KAAL,GAAa,KAAKT,EAAlB;AACAiB,MAAAA,KAAK,CAAC,qCAAD,CAAL;AACH;AACJ,GAtBD;;AAwBA,MAAIQ,sBAAsB,GAAG3B,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAA7B;AACA0B,EAAAA,sBAAsB,CAACxB,SAAvB,GAAmC,WAAnC;AACAwB,EAAAA,sBAAsB,CAACtB,IAAvB,GAA8B,QAA9B;AACAsB,EAAAA,sBAAsB,CAACzB,EAAvB,GAA4B,kBAAkBoB,UAA9C;AACAK,EAAAA,sBAAsB,CAACrB,YAAvB,CAAoC,YAApC,EAAkD,OAAlD;;AACAqB,EAAAA,sBAAsB,CAACpB,OAAvB,GAAiC,YAAW;AACxClB,IAAAA,IAAI,CAAC,UAAD,CAAJ,CAAiBuC,MAAjB,CAAwBN,UAAxB,EAAoC,CAApC;AACApC,IAAAA,CAAC,CAAC,SAAS,SAAT,GAAqBoC,UAAtB,CAAD,CAAmCd,MAAnC;AACH,GAHD;;AAKAgB,EAAAA,QAAQ,CAACf,MAAT,CAAgBC,QAAhB;AACAc,EAAAA,QAAQ,CAACf,MAAT,CAAgBkB,sBAAhB;AACAJ,EAAAA,WAAW,CAACd,MAAZ,CAAmBe,QAAnB;AAEA,MAAIK,QAAQ,GAAG7B,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAf;AACA4B,EAAAA,QAAQ,CAAC1B,SAAT,GAAqB,OAArB;AAEA,MAAI2B,QAAQ,GAAG9B,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAf;AAEA,MAAI8B,KAAK,GAAG/B,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAZ;AAEA,MAAI+B,KAAK,GAAGhC,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAZ;AAEA8B,EAAAA,KAAK,CAACtB,MAAN,CAAauB,KAAb;AAEA,MAAIC,cAAc,GAAGjC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAArB;;AAhEqD,6BAkE5CH,CAlE4C;AAmEjDkC,IAAAA,KAAK,GAAGhC,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAR;AACAgC,IAAAA,cAAc,GAAGjC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAjB;AACAgC,IAAAA,cAAc,CAACtB,KAAf,GAAuBU,IAAI,CAAC,OAAD,CAAJ,CAAcvB,CAAd,CAAvB;AACAmC,IAAAA,cAAc,CAAC9B,SAAf,GAA2B,kCAA3B;;AACA8B,IAAAA,cAAc,CAACrB,QAAf,GAA0B,YAAW;AACjC,UAAIa,aAAa,GAAG,KAApB;;AAEA,UAAI,KAAKd,KAAL,CAAWI,MAAX,GAAoB,CAAxB,EAA2B;AACvB,aAAK,IAAIW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,IAAI,CAAC,OAAD,CAAJ,CAAcN,MAAlC,EAA0CW,CAAC,EAA3C,EAA+C;AAC3C,cAAIL,IAAI,CAAC,OAAD,CAAJ,CAAcK,CAAd,MAAqB,KAAKf,KAA9B,EAAqC;AACjCc,YAAAA,aAAa,GAAG,IAAhB;AACH;AACJ;;AACD,YAAI,CAACA,aAAL,EAAoB;AAChBJ,UAAAA,IAAI,CAAC,OAAD,CAAJ,CAAcvB,CAAd,IAAmB,KAAKa,KAAxB;AACH,SAFD,MAEO;AACH,eAAKA,KAAL,GAAaU,IAAI,CAAC,OAAD,CAAJ,CAAcvB,CAAd,CAAb;AACAqB,UAAAA,KAAK,CAAC,qCAAD,CAAL;AACH;AACJ,OAZD,MAYO;AACH,aAAKR,KAAL,GAAaU,IAAI,CAAC,OAAD,CAAJ,CAAcvB,CAAd,CAAb;AACAqB,QAAAA,KAAK,CAAC,qCAAD,CAAL;AACH;AACJ,KAnBD;;AAqBA,QAAIe,oBAAoB,GAAGlC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAA3B;AACAiC,IAAAA,oBAAoB,CAAC/B,SAArB,GAAiC,WAAjC;AACA+B,IAAAA,oBAAoB,CAAC7B,IAArB,GAA4B,QAA5B;AACA6B,IAAAA,oBAAoB,CAAC5B,YAArB,CAAkC,YAAlC,EAAgD,OAAhD;;AACA4B,IAAAA,oBAAoB,CAAC3B,OAArB,GAA+B,YAAW;AACtC,WAAK,IAAIT,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,GAAC,EAA9C,EAAkD;AAC9CZ,QAAAA,CAAC,CAAC,gBAAcY,GAAf,CAAD,CAAmBU,MAAnB;AACH;;AACDa,MAAAA,IAAI,CAAC,OAAD,CAAJ,CAAcO,MAAd,CAAqB9B,CAArB,EAAwB,CAAxB;;AACA,WAAK,IAAIA,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,GAAC,EAA9C,EAAkD;AAC9CsB,QAAAA,qBAAqB,CAAC/B,IAAI,CAAC,UAAD,CAAJ,CAAiBS,GAAjB,CAAD,EAAsBA,GAAtB,EAAyBV,kBAAzB,CAArB;AACH;AACJ,KARD;;AASA4C,IAAAA,KAAK,CAACvB,MAAN,CAAawB,cAAb;AACAD,IAAAA,KAAK,CAACvB,MAAN,CAAayB,oBAAb;AACAH,IAAAA,KAAK,CAACtB,MAAN,CAAauB,KAAb;AA3GiD;;AAkErD,OAAK,IAAIlC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuB,IAAI,CAAC,OAAD,CAAJ,CAAcN,MAAlC,EAA0CjB,CAAC,EAA3C,EAA+C;AAAA,UAAtCA,CAAsC;AA0C9C;;AACDkC,EAAAA,KAAK,GAAGhC,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAR;AACA+B,EAAAA,KAAK,CAAC7B,SAAN,GAAkB,YAAlB;AACA,MAAIgC,iBAAiB,GAAGnC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAxB;AACAkC,EAAAA,iBAAiB,CAAChC,SAAlB,GAA8B,gCAA9B;AACAgC,EAAAA,iBAAiB,CAAC9B,IAAlB,GAAyB,QAAzB;AACA8B,EAAAA,iBAAiB,CAACjC,EAAlB,GAAuB,sBAAsBoB,UAA7C;AACAa,EAAAA,iBAAiB,CAACC,SAAlB,GAA8B,GAA9B;;AACAD,EAAAA,iBAAiB,CAAC5B,OAAlB,GAA4B,YAAW;AACnC,SAAK,IAAIT,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,EAAC,EAA9C,EAAkD;AAC9CZ,MAAAA,CAAC,CAAC,gBAAcY,EAAf,CAAD,CAAmBU,MAAnB;AACH;;AACDa,IAAAA,IAAI,CAAC,OAAD,CAAJ,CAAcgB,IAAd,CAAmB,WAAShB,IAAI,CAAC,OAAD,CAAJ,CAAcN,MAA1C;;AACA,SAAK,IAAIjB,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,GAAC,EAA9C,EAAkD;AAC9CsB,MAAAA,qBAAqB,CAAC/B,IAAI,CAAC,UAAD,CAAJ,CAAiBS,GAAjB,CAAD,EAAsBA,GAAtB,EAAyBV,kBAAzB,CAArB;AACH;AACJ,GARD;;AAUA4C,EAAAA,KAAK,CAACvB,MAAN,CAAa0B,iBAAb;AACAJ,EAAAA,KAAK,CAACtB,MAAN,CAAauB,KAAb;AACAF,EAAAA,QAAQ,CAACrB,MAAT,CAAgBsB,KAAhB;AACAF,EAAAA,QAAQ,CAACpB,MAAT,CAAgBqB,QAAhB;AAEA,MAAIQ,QAAQ,GAAGtC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAf;AAEA,MAAIsC,KAAJ;;AArIqD,+BAuI5CzC,GAvI4C;AAwIjDiC,IAAAA,KAAK,GAAG/B,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAR;AACAsC,IAAAA,KAAK,GAAGvC,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAR;AACAgC,IAAAA,cAAc,GAAGjC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAjB;AACAgC,IAAAA,cAAc,CAACtB,KAAf,GAAuBU,IAAI,CAAC,aAAD,CAAJ,CAAoBvB,GAApB,EAAuB,UAAvB,CAAvB;AACAmC,IAAAA,cAAc,CAAC9B,SAAf,GAA2B,MAA3B;;AACA8B,IAAAA,cAAc,CAACrB,QAAf,GAA0B,YAAW;AACjC,UAAIa,aAAa,GAAG,KAApB;;AAEA,UAAI,KAAKd,KAAL,CAAWI,MAAX,GAAoB,CAAxB,EAA2B;AACvB,aAAK,IAAIW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,IAAI,CAAC,aAAD,CAAJ,CAAoBN,MAAxC,EAAgDW,CAAC,EAAjD,EAAqD;AACjD,cAAIL,IAAI,CAAC,aAAD,CAAJ,CAAoBK,CAApB,EAAuB,UAAvB,MAAuC,KAAKf,KAAhD,EAAuD;AACnDc,YAAAA,aAAa,GAAG,IAAhB;AACH;AACJ;;AACD,YAAI,CAACA,aAAL,EAAoB;AAChBJ,UAAAA,IAAI,CAAC,aAAD,CAAJ,CAAoBvB,GAApB,EAAuB,UAAvB,IAAqC,KAAKa,KAA1C;AACH,SAFD,MAEO;AACH,eAAKA,KAAL,GAAaU,IAAI,CAAC,aAAD,CAAJ,CAAoBvB,GAApB,EAAuB,UAAvB,CAAb;AACAqB,UAAAA,KAAK,CAAC,qCAAD,CAAL;AACH;AACJ,OAZD,MAYO;AACH,aAAKR,KAAL,GAAaU,IAAI,CAAC,aAAD,CAAJ,CAAoBvB,GAApB,EAAuB,UAAvB,CAAb;AACAqB,QAAAA,KAAK,CAAC,qCAAD,CAAL;AACH;AACJ,KAnBD;;AAqBA,QAAIe,oBAAoB,GAAGlC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAA3B;AACAiC,IAAAA,oBAAoB,CAAC/B,SAArB,GAAiC,WAAjC;AACA+B,IAAAA,oBAAoB,CAAC7B,IAArB,GAA4B,QAA5B;AACA6B,IAAAA,oBAAoB,CAAC5B,YAArB,CAAkC,YAAlC,EAAgD,OAAhD;;AACA4B,IAAAA,oBAAoB,CAAC3B,OAArB,GAA+B,YAAW;AACtC,WAAK,IAAIT,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,GAAC,EAA9C,EAAkD;AAC9CZ,QAAAA,CAAC,CAAC,gBAAcY,GAAf,CAAD,CAAmBU,MAAnB;AACH;;AACDa,MAAAA,IAAI,CAAC,aAAD,CAAJ,CAAoBO,MAApB,CAA2B9B,GAA3B,EAA8B,CAA9B;;AACA,WAAK,IAAIA,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,GAAC,EAA9C,EAAkD;AAC9CsB,QAAAA,qBAAqB,CAAC/B,IAAI,CAAC,UAAD,CAAJ,CAAiBS,GAAjB,CAAD,EAAsBA,GAAtB,EAAyBV,kBAAzB,CAArB;AACH;AACJ,KARD;;AASAmD,IAAAA,KAAK,CAAC9B,MAAN,CAAayB,oBAAb;AACAK,IAAAA,KAAK,CAAC9B,MAAN,CAAawB,cAAb;AACAF,IAAAA,KAAK,CAACtB,MAAN,CAAa8B,KAAb;AAEA,QAAIC,mBAAmB,SAAvB;;AAnLiD,iCAoLxCd,CApLwC;AAqL7Ca,MAAAA,KAAK,GAAGvC,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAR;AACAsC,MAAAA,KAAK,CAACpC,SAAN,GAAkB,aAAlB;AACAqC,MAAAA,mBAAmB,GAAGxC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAtB;AACAuC,MAAAA,mBAAmB,CAACnC,IAApB,GAA2B,OAA3B;AACAmC,MAAAA,mBAAmB,CAACC,IAApB,GAA2BpB,IAAI,CAAC,aAAD,CAAJ,CAAoBvB,GAApB,EAAuB,UAAvB,CAA3B;;AACA,UAAIuB,IAAI,CAAC,aAAD,CAAJ,CAAoBvB,GAApB,EAAuB,QAAvB,KAAoC4B,CAAxC,EAA2C;AACvCc,QAAAA,mBAAmB,CAACE,OAApB,GAA8B,IAA9B;AACAF,QAAAA,mBAAmB,CAACrC,SAApB,IAAiC,SAAjC;AACH;;AACDqC,MAAAA,mBAAmB,CAACjC,OAApB,GAA8B,YAAW;AACrCc,QAAAA,IAAI,CAAC,aAAD,CAAJ,CAAoBvB,GAApB,EAAuB,QAAvB,IAAmC4B,CAAnC;AACH,OAFD;;AAGAa,MAAAA,KAAK,CAAC9B,MAAN,CAAa+B,mBAAb;AACAT,MAAAA,KAAK,CAACtB,MAAN,CAAa8B,KAAb;AAlM6C;;AAoLjD,SAAK,IAAIb,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,IAAI,CAAC,OAAD,CAAJ,CAAcN,MAAlC,EAA0CW,CAAC,EAA3C,EAA+C;AAAA,aAAtCA,CAAsC;AAe9C;;AACDY,IAAAA,QAAQ,CAAC7B,MAAT,CAAgBsB,KAAhB;AApMiD;;AAuIrD,OAAK,IAAIjC,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGuB,IAAI,CAAC,aAAD,CAAJ,CAAoBN,MAAxC,EAAgDjB,GAAC,EAAjD,EAAqD;AAAA,WAA5CA,GAA4C;AA8DpD;;AACD+B,EAAAA,QAAQ,CAACpB,MAAT,CAAgB6B,QAAhB;AACAf,EAAAA,WAAW,CAACd,MAAZ,CAAmBoB,QAAnB;AAEA,MAAIc,uBAAuB,GAAG3C,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAA9B;AACA0C,EAAAA,uBAAuB,CAACxC,SAAxB,GAAoC,gCAApC;AACAwC,EAAAA,uBAAuB,CAACtC,IAAxB,GAA+B,QAA/B;AACAsC,EAAAA,uBAAuB,CAACzC,EAAxB,GAA6B,wBAA7B;AACAyC,EAAAA,uBAAuB,CAACP,SAAxB,GAAoC,GAApC;;AACAO,EAAAA,uBAAuB,CAACpC,OAAxB,GAAkC,YAAW;AACzC,SAAK,IAAIT,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,GAAC,EAA9C,EAAkD;AAC9CZ,MAAAA,CAAC,CAAC,gBAAcY,GAAf,CAAD,CAAmBU,MAAnB;AACH;;AACDa,IAAAA,IAAI,CAAC,aAAD,CAAJ,CAAoBgB,IAApB,CAAyB;AAAC,kBAAY,gBAAchB,IAAI,CAAC,aAAD,CAAJ,CAAoBN,MAA/C;AAAsD,gBAAU,CAAhE;AAAkE,mBAAa,CAAC;AAAhF,KAAzB;;AACA,SAAK,IAAIjB,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,GAAC,EAA9C,EAAkD;AAC9CsB,MAAAA,qBAAqB,CAAC/B,IAAI,CAAC,UAAD,CAAJ,CAAiBS,GAAjB,CAAD,EAAsBA,GAAtB,EAAyBV,kBAAzB,CAArB;AACH;AACJ,GARD;;AAUAmC,EAAAA,WAAW,CAACd,MAAZ,CAAmBkC,uBAAnB;AACA5C,EAAAA,MAAM,CAACU,MAAP,CAAcc,WAAd;AACA1B,EAAAA,MAAM,CAACY,MAAP,CAAcV,MAAd;AACH;;AAED,SAAS6C,mBAAT,GAAgC;AAC5B;AACA,MAAIvD,IAAI,CAAC2B,cAAL,CAAoB,aAApB,CAAJ,EAAwC;AACpC,WAAO3B,IAAI,CAAC,aAAD,CAAX;AACH,GAFD,MAEO;AAAE;AACLA,IAAAA,IAAI,CAAC,aAAD,CAAJ,GAAsB,EAAtB;AACH;AACJ;;AAED,SAASwD,SAAT,GAAqB;AACjB,MAAIjD,GAAG,GAAG,aAAakD,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,IAA3B,CAAvB;AACAtD,EAAAA,aAAa,CAAC2C,IAAd,CAAmBzC,GAAnB;AACAP,EAAAA,IAAI,CAACO,GAAD,CAAJ,GAAY,EAAZ;AACAD,EAAAA,mBAAmB,CAACC,GAAD,EAAMT,iBAAN,EAAyBO,aAAa,CAACqB,MAAd,GAAuB,CAAhD,CAAnB;AACH;;AAED,SAASkC,WAAT,GAAuB;AACnB,MAAIrD,GAAG,GAAG;AACN,aAAS,aAAakD,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,CAA3B,CADhB;AAEN,aAAS,EAFH;AAGN,mBAAe;AAHT,GAAV;AAKA3D,EAAAA,IAAI,CAAC,UAAD,CAAJ,CAAiBgD,IAAjB,CAAsBzC,GAAtB;AACAwB,EAAAA,qBAAqB,CAACxB,GAAD,EAAMP,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAAjB,GAAwB,CAA9B,EAAiC3B,kBAAjC,CAArB;AACH;;AAED,SAAS8D,SAAT,GAAqB;AACjB,MAAIC,GAAG,GAAG,IAAIC,cAAJ,EAAV;AACA,MAAIC,GAAG,GAAGnE,CAAC,CAAC,oBAAD,CAAD,CAAwBoE,GAAxB,EAAV;AACAH,EAAAA,GAAG,CAACI,IAAJ,CAAS,MAAT,EAAiBF,GAAjB,EAAsB,IAAtB;AACAF,EAAAA,GAAG,CAACK,gBAAJ,CAAqB,cAArB,EAAqC,kBAArC;AACAL,EAAAA,GAAG,CAACM,IAAJ,CAASnE,IAAI,CAAC2B,SAAL,CAAe5B,IAAf,CAAT;AACAqE,EAAAA,MAAM,CAACC,QAAP,CAAgBzC,OAAhB,CAAwBmC,GAAxB;AACH,C,CAED;;;AACA,SAASO,IAAT,GAAgB;AACZ,MAAIlC,CAAC,GAAG,CAAR;AACAmC,EAAAA,OAAO,CAACC,GAAR,CAAYzE,IAAZ;;AACA,OAAK,IAAIO,GAAT,IAAgBP,IAAhB,EAAqB;AACjB,YAAQO,GAAR;AACI,WAAK,aAAL;AACIV,QAAAA,CAAC,CAAC,mBAAD,CAAD,CAAuB6E,IAAvB,CAA4B,SAA5B,EAAuC,SAAvC;AACA;;AACJ,WAAK,UAAL;AACI,aAAK,IAAIjE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,IAAI,CAAC,UAAD,CAAJ,CAAiB0B,MAArC,EAA6CjB,CAAC,EAA9C,EAAkD;AAC9CsB,UAAAA,qBAAqB,CAAC/B,IAAI,CAAC,UAAD,CAAJ,CAAiBS,CAAjB,CAAD,EAAsBA,CAAtB,EAAyBV,kBAAzB,CAArB;AACH;;AACD;;AACJ;AACIM,QAAAA,aAAa,CAAC2C,IAAd,CAAmBzC,GAAnB;AACAD,QAAAA,mBAAmB,CAACC,GAAD,EAAMT,iBAAN,EAAyBuC,CAAC,EAA1B,CAAnB;AAXR;AAaH;AACJ;;AAEDkC,IAAI,G,CAEJ;;AACA1E,CAAC,CAAC;AAAA,SACMA,CAAC,CAAC,yBAAD,CAAD,CAA6B8E,EAA7B,CAAgC,OAAhC,EAAyC;AAAA,WAAMnB,SAAS,EAAf;AAAA,GAAzC,CADN;AAAA,CAAD,EAEO3D,CAAC,CAAC,oBAAD,CAAD,CAAwB8E,EAAxB,CAA2B,OAA3B,EAAoC;AAAA,SAAMd,SAAS,EAAf;AAAA,CAApC,CAFP,EAGOhE,CAAC,CAAC,2BAAD,CAAD,CAA+B8E,EAA/B,CAAkC,OAAlC,EAA2C;AAAA,SAAMf,WAAW,EAAjB;AAAA,CAA3C,CAHP,EAIO/D,CAAC,CAAC,mBAAD,CAAD,CAAuB8E,EAAvB,CAA0B,QAA1B,EAAoC;AAAA,SAAMpB,mBAAmB,EAAzB;AAAA,CAApC,CAJP,CAAD;AAOA1D,CAAC,CAAC,YAAD,CAAD,CAAgB+E,MAAhB,CAAuB,YAAU;AAC7BP,EAAAA,MAAM,CAACC,QAAP,CAAgBzC,OAAhB,CAAwBhC,CAAC,CAAC,IAAD,CAAD,CAAQoE,GAAR,EAAxB;AACH,CAFD","sourcesContent":["import $ from 'jquery';\r\n\r\nvar libelle_container = $(\"div#libelle\")\r\nvar sections_container = $(\"div#sections\")\r\nvar json = JSON.parse($(\"p#mydata\").html());\r\nvar tmp_json = 1;\r\n\r\nvar labelle_table = [];\r\n\r\n// Ajout de \"Input\" pour un parent donné\r\nfunction add_input_to_parent(key, parent, i) {\r\n    let newdiv = document.createElement(\"div\");\r\n    newdiv.id = i;\r\n    newdiv.className = \"my-2 px-3\";\r\n\r\n    let newCloseButton = document.createElement(\"button\");\r\n    newCloseButton.className = \"btn-close\";\r\n    newCloseButton.type = \"button\";\r\n    newCloseButton.setAttribute(\"aria-label\", \"Close\");\r\n    newCloseButton.onclick = function() {\r\n        delete json[labelle_table[i]];\r\n        $('div#' + i).remove();\r\n    };\r\n    newdiv.append(newCloseButton);\r\n\r\n    let newInput = document.createElement(\"input\");\r\n    newInput.value = key;\r\n    newInput.className = \"capitalized formLabel formLabel-large text-mediumblue\";\r\n    newInput.onchange = function() {\r\n        let current_val = this.value;\r\n        let current_id = labelle_table[i];\r\n        if (this.value.length > 0) {\r\n            if (!json.hasOwnProperty(current_val)) {\r\n                labelle_table[i] = current_val;\r\n                json = JSON.parse((JSON.stringify(json)).replace(current_id, current_val));\r\n            } else {\r\n                this.value = current_id;\r\n                alert(\"Ce champ est déjà existant.\")\r\n            }\r\n        } else {\r\n            this.value = current_id;\r\n            alert(\"Impossible de mettre un libellé vide.\")\r\n        }\r\n    };\r\n    newdiv.append(newInput);\r\n\r\n    newdiv.append(document.createElement(\"br\"));\r\n    newdiv.append(document.createElement(\"br\"));\r\n    parent.append(newdiv);\r\n}\r\n\r\n// Ajout de \"Section\" pour un parent donné\r\nfunction add_section_to_parent(data, section_id, parent) {\r\n    let newdiv = document.createElement(\"div\");\r\n    newdiv.id =  \"section\" + section_id;\r\n    newdiv.className = \"section\";\r\n\r\n    let newdivBlock = document.createElement(\"div\");\r\n    newdivBlock.className = \"block block-large\";\r\n\r\n    let newdivst = document.createElement(\"div\");\r\n    newdivst.className = \"sous-titre\";\r\n\r\n    let newInput = document.createElement(\"input\");\r\n    newInput.value = data[\"titre\"];\r\n    newInput.id = data[\"titre\"];\r\n    newInput.className = \"capitalized formLabel formLabel-large text-mediumblue\";\r\n    newInput.onchange = function() {\r\n        let current_val = this.value;\r\n        let already_exist = false;\r\n\r\n        if (this.value.length > 0) {\r\n            let current_id = this.id;\r\n            for (let j = 0; j < json['sections'].length; j++) {\r\n                if (json['sections'][j]['titre'] === current_val) {\r\n                    already_exist = true;\r\n                }\r\n            }\r\n            if (!already_exist) {\r\n                json = JSON.parse((JSON.stringify(json)).replace(current_id, current_val));\r\n                this.id = current_val;\r\n            } else {\r\n                this.value = current_id;\r\n                alert(\"Une section possède déjà ce titre.\");\r\n            }\r\n        } else {\r\n            this.value = this.id;\r\n            alert(\"Impossible de mettre un titre vide.\")\r\n        }\r\n    };\r\n\r\n    let newDeleteSectionButton = document.createElement(\"button\");\r\n    newDeleteSectionButton.className = \"btn-close\";\r\n    newDeleteSectionButton.type = \"button\";\r\n    newDeleteSectionButton.id = 'buttonsection' + section_id;\r\n    newDeleteSectionButton.setAttribute(\"aria-label\", \"Close\");\r\n    newDeleteSectionButton.onclick = function() {\r\n        json[\"sections\"].splice(section_id, 1);\r\n        $('div#' + 'section' + section_id).remove();\r\n    };\r\n\r\n    newdivst.append(newInput);\r\n    newdivst.append(newDeleteSectionButton);\r\n    newdivBlock.append(newdivst);\r\n\r\n    let newtable = document.createElement(\"table\");\r\n    newtable.className = \"table\";\r\n\r\n    let newthead = document.createElement(\"thead\");\r\n\r\n    let newtr = document.createElement(\"tr\");\r\n\r\n    let newth = document.createElement(\"th\");\r\n\r\n    newtr.append(newth);\r\n\r\n    let newInputchoice = document.createElement(\"input\");\r\n\r\n    for (let i = 0; i < data[\"choix\"].length; i++) {\r\n        newth = document.createElement(\"th\");\r\n        newInputchoice = document.createElement(\"input\");\r\n        newInputchoice.value = data['choix'][i];\r\n        newInputchoice.className = \"text-center text-mediumblue w-80\";\r\n        newInputchoice.onchange = function() {\r\n            let already_exist = false;\r\n\r\n            if (this.value.length > 0) {\r\n                for (let j = 0; j < data['choix'].length; j++) {\r\n                    if (data['choix'][j] === this.value) {\r\n                        already_exist = true;\r\n                    }\r\n                }\r\n                if (!already_exist) {\r\n                    data['choix'][i] = this.value;\r\n                } else {\r\n                    this.value = data['choix'][i];\r\n                    alert(\"Un choix possède déjà cet intitulé.\")\r\n                }\r\n            } else {\r\n                this.value = data['choix'][i];\r\n                alert(\"Impossible de mettre un choix vide.\")\r\n            }\r\n        };\r\n\r\n        let newCloseButtonChoice = document.createElement(\"button\");\r\n        newCloseButtonChoice.className = \"btn-close\";\r\n        newCloseButtonChoice.type = \"button\";\r\n        newCloseButtonChoice.setAttribute(\"aria-label\", \"Close\");\r\n        newCloseButtonChoice.onclick = function() {\r\n            for (let i = 0; i < json['sections'].length; i++) {\r\n                $(\"div#section\"+i).remove();\r\n            }\r\n            data['choix'].splice(i, 1);\r\n            for (let i = 0; i < json['sections'].length; i++) {\r\n                add_section_to_parent(json['sections'][i], i, sections_container);\r\n            }\r\n        };\r\n        newth.append(newInputchoice);\r\n        newth.append(newCloseButtonChoice);\r\n        newtr.append(newth);\r\n    }\r\n    newth = document.createElement(\"th\");\r\n    newth.className = \"text-right\";\r\n    let newAddChoixButton = document.createElement(\"button\");\r\n    newAddChoixButton.className = \"btn btn-round btn-sm px-3 mt-2\";\r\n    newAddChoixButton.type = \"button\";\r\n    newAddChoixButton.id = \"add_choix_button_\" + section_id;\r\n    newAddChoixButton.innerHTML = '+';\r\n    newAddChoixButton.onclick = function() {\r\n        for (let i = 0; i < json['sections'].length; i++) {\r\n            $(\"div#section\"+i).remove();\r\n        }\r\n        data['choix'].push(\"Choix#\"+data['choix'].length);\r\n        for (let i = 0; i < json['sections'].length; i++) {\r\n            add_section_to_parent(json['sections'][i], i, sections_container);\r\n        }\r\n    };\r\n\r\n    newth.append(newAddChoixButton);\r\n    newtr.append(newth);\r\n    newthead.append(newtr);\r\n    newtable.append(newthead);\r\n\r\n    let newtbody = document.createElement(\"tbody\");\r\n\r\n    let newtd;\r\n\r\n    for (let i = 0; i < data[\"competences\"].length; i++) {\r\n        newtr = document.createElement(\"tr\");\r\n        newtd = document.createElement(\"td\");\r\n        newInputchoice = document.createElement(\"input\");\r\n        newInputchoice.value = data['competences'][i][\"intitule\"];\r\n        newInputchoice.className = \"w-80\";\r\n        newInputchoice.onchange = function() {\r\n            let already_exist = false;\r\n\r\n            if (this.value.length > 0) {\r\n                for (let j = 0; j < data['competences'].length; j++) {\r\n                    if (data['competences'][j][\"intitule\"] === this.value) {\r\n                        already_exist = true;\r\n                    }\r\n                }\r\n                if (!already_exist) {\r\n                    data['competences'][i][\"intitule\"] = this.value;\r\n                } else {\r\n                    this.value = data['competences'][i][\"intitule\"];\r\n                    alert(\"Un choix possède déjà cet intitulé.\")\r\n                }\r\n            } else {\r\n                this.value = data['competences'][i][\"intitule\"];\r\n                alert(\"Impossible de mettre un choix vide.\");\r\n            }\r\n        };\r\n\r\n        let newCloseButtonChoice = document.createElement(\"button\");\r\n        newCloseButtonChoice.className = \"btn-close\";\r\n        newCloseButtonChoice.type = \"button\";\r\n        newCloseButtonChoice.setAttribute(\"aria-label\", \"Close\");\r\n        newCloseButtonChoice.onclick = function() {\r\n            for (let i = 0; i < json['sections'].length; i++) {\r\n                $(\"div#section\"+i).remove();\r\n            }\r\n            data['competences'].splice(i, 1);\r\n            for (let i = 0; i < json['sections'].length; i++) {\r\n                add_section_to_parent(json['sections'][i], i, sections_container);\r\n            }\r\n        };\r\n        newtd.append(newCloseButtonChoice);\r\n        newtd.append(newInputchoice);\r\n        newtr.append(newtd);\r\n\r\n        let newInputRadioButton;\r\n        for (let j = 0; j < data['choix'].length; j++) {\r\n            newtd = document.createElement(\"td\");\r\n            newtd.className = \"text-center\";\r\n            newInputRadioButton = document.createElement(\"input\");\r\n            newInputRadioButton.type = \"radio\";\r\n            newInputRadioButton.name = data['competences'][i][\"intitule\"];\r\n            if (data['competences'][i][\"requis\"] == j) {\r\n                newInputRadioButton.checked = true;\r\n                newInputRadioButton.className += \" requis\";\r\n            }\r\n            newInputRadioButton.onclick = function() {\r\n                data['competences'][i][\"requis\"] = j;\r\n            };\r\n            newtd.append(newInputRadioButton);\r\n            newtr.append(newtd);\r\n        }\r\n        newtbody.append(newtr);\r\n    }\r\n    newtable.append(newtbody);\r\n    newdivBlock.append(newtable);\r\n\r\n    let newAddButtonCompetences = document.createElement(\"button\");\r\n    newAddButtonCompetences.className = \"btn btn-round btn-sm px-3 mt-2\";\r\n    newAddButtonCompetences.type = \"button\";\r\n    newAddButtonCompetences.id = \"add_competences_button\";\r\n    newAddButtonCompetences.innerHTML = '+';\r\n    newAddButtonCompetences.onclick = function() {\r\n        for (let i = 0; i < json['sections'].length; i++) {\r\n            $(\"div#section\"+i).remove();\r\n        }\r\n        data['competences'].push({\"intitule\": \"competence#\"+data['competences'].length,\"requis\": 0,\"selection\": -1});\r\n        for (let i = 0; i < json['sections'].length; i++) {\r\n            add_section_to_parent(json['sections'][i], i, sections_container);\r\n        }\r\n    };\r\n\r\n    newdivBlock.append(newAddButtonCompetences);\r\n    newdiv.append(newdivBlock);\r\n    parent.append(newdiv);\r\n}\r\n\r\nfunction commentaire_manager () {\r\n    // Ajout du commentaire dans le formulaire\r\n    if (json.hasOwnProperty('commentaire')) {\r\n        delete json[\"commentaire\"];\r\n    } else { // Suppression du commentaire dans le formulaire\r\n        json[\"commentaire\"] = \"\";\r\n    }\r\n}\r\n\r\nfunction add_label() {\r\n    let key = \"libelle#\" + Math.floor(Math.random() * 9000);\r\n    labelle_table.push(key);\r\n    json[key] = \"\";\r\n    add_input_to_parent(key, libelle_container, labelle_table.length - 1);\r\n}\r\n\r\nfunction add_section() {\r\n    let key = {\r\n        \"titre\": \"Titre n°\" + Math.floor(Math.random() * 5),\r\n        \"choix\": [],\r\n        \"competences\": []\r\n    };\r\n    json['sections'].push(key);\r\n    add_section_to_parent(key, json['sections'].length-1, sections_container);\r\n}\r\n\r\nfunction send_json() {\r\n    let xhr = new XMLHttpRequest();\r\n    let url = $('button#send_button').val();\r\n    xhr.open(\"POST\", url, true);\r\n    xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    xhr.send(JSON.stringify(json));\r\n    window.location.replace(url);\r\n}\r\n\r\n// Fonction de génération des champs personalisable par le JSON en BDD\r\nfunction main() {\r\n    var j = 0;\r\n    console.log(json)\r\n    for (var key in json){\r\n        switch (key) {\r\n            case 'commentaire':\r\n                $('input#commentaire').attr(\"checked\", \"checked\");\r\n                break;\r\n            case 'sections':\r\n                for (let i = 0; i < json['sections'].length; i++) {\r\n                    add_section_to_parent(json['sections'][i], i, sections_container);\r\n                }\r\n                break;\r\n            default:\r\n                labelle_table.push(key);\r\n                add_input_to_parent(key, libelle_container, j++);\r\n        }\r\n    }\r\n}\r\n\r\nmain();\r\n\r\n// Event Listener\r\n$(() =>\r\n        $('button#add_label_button').on('click', () => add_label()),\r\n        $('button#send_button').on('click', () => send_json()),\r\n        $('button#add_section_button').on('click', () => add_section()),\r\n        $('input#commentaire').on('change', () => commentaire_manager ())\r\n);\r\n\r\n$('select#ver').change(function(){\r\n    window.location.replace($(this).val());\r\n});"]},"metadata":{},"sourceType":"module"}